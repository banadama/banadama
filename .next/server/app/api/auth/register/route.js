"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/register/route";
exports.ids = ["app/api/auth/register/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist\\client\\components\\action-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist\\client\\components\\action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist\\client\\components\\request-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist\\client\\components\\request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!*********************************************************************************************!*\
  !*** external "next/dist\\client\\components\\static-generation-async-storage.external.js" ***!
  \*********************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist\\client\\components\\static-generation-async-storage.external.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(rsc)/../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=C%3A%5CUsers%5CABDULRAMAN%20LAWAL%5CDesktop%5CBanadama2.0%5Cbanadama-platform%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CABDULRAMAN%20LAWAL%5CDesktop%5CBanadama2.0%5Cbanadama-platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=C%3A%5CUsers%5CABDULRAMAN%20LAWAL%5CDesktop%5CBanadama2.0%5Cbanadama-platform%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CABDULRAMAN%20LAWAL%5CDesktop%5CBanadama2.0%5Cbanadama-platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@14.0.0_@babel+core@7.2_d581c8e324c8c8e93d52c4758017b76b/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/.pnpm/next@14.0.0_@babel+core@7.2_d581c8e324c8c8e93d52c4758017b76b/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var C_Users_ABDULRAMAN_LAWAL_Desktop_Banadama2_0_banadama_platform_app_api_auth_register_route_ts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./app/api/auth/register/route.ts */ \"(rsc)/./app/api/auth/register/route.ts\");\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/register/route\",\n        pathname: \"/api/auth/register\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/register/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\ABDULRAMAN LAWAL\\\\Desktop\\\\Banadama2.0\\\\banadama-platform\\\\app\\\\api\\\\auth\\\\register\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_ABDULRAMAN_LAWAL_Desktop_Banadama2_0_banadama_platform_app_api_auth_register_route_ts__WEBPACK_IMPORTED_MODULE_2__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/auth/register/route\";\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyLmpzP25hbWU9YXBwJTJGYXBpJTJGYXV0aCUyRnJlZ2lzdGVyJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhdXRoJTJGcmVnaXN0ZXIlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZhdXRoJTJGcmVnaXN0ZXIlMkZyb3V0ZS50cyZhcHBEaXI9QyUzQSU1Q1VzZXJzJTVDQUJEVUxSQU1BTiUyMExBV0FMJTVDRGVza3RvcCU1Q0JhbmFkYW1hMi4wJTVDYmFuYWRhbWEtcGxhdGZvcm0lNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q0FCRFVMUkFNQU4lMjBMQVdBTCU1Q0Rlc2t0b3AlNUNCYW5hZGFtYTIuMCU1Q2JhbmFkYW1hLXBsYXRmb3JtJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNzRTtBQUNySTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNpSjs7QUFFakoiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYW5hZGFtYS1wbGF0Zm9ybS8/MDgzYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxBQkRVTFJBTUFOIExBV0FMXFxcXERlc2t0b3BcXFxcQmFuYWRhbWEyLjBcXFxcYmFuYWRhbWEtcGxhdGZvcm1cXFxcYXBwXFxcXGFwaVxcXFxhdXRoXFxcXHJlZ2lzdGVyXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdXRoL3JlZ2lzdGVyL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYXV0aC9yZWdpc3RlclwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYXV0aC9yZWdpc3Rlci9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXEFCRFVMUkFNQU4gTEFXQUxcXFxcRGVza3RvcFxcXFxCYW5hZGFtYTIuMFxcXFxiYW5hZGFtYS1wbGF0Zm9ybVxcXFxhcHBcXFxcYXBpXFxcXGF1dGhcXFxccmVnaXN0ZXJcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvYXV0aC9yZWdpc3Rlci9yb3V0ZVwiO1xuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQsIG9yaWdpbmFsUGF0aG5hbWUsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=C%3A%5CUsers%5CABDULRAMAN%20LAWAL%5CDesktop%5CBanadama2.0%5Cbanadama-platform%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CABDULRAMAN%20LAWAL%5CDesktop%5CBanadama2.0%5Cbanadama-platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/register/route.ts":
/*!****************************************!*\
  !*** ./app/api/auth/register/route.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/.pnpm/next@14.0.0_@babel+core@7.2_d581c8e324c8c8e93d52c4758017b76b/node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/.pnpm/bcryptjs@3.0.3/node_modules/bcryptjs/index.js\");\n// app/api/auth/register/route.ts\n\n\n\n\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { email, password, role, country, profileData } = body;\n        // Validation\n        if (!email || !password || !role) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Missing required fields: email, password, role\"\n            }, {\n                status: 400\n            });\n        }\n        // Email validation\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        if (!emailRegex.test(email)) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Invalid email format\"\n            }, {\n                status: 400\n            });\n        }\n        // Password strength\n        if (password.length < 8) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Password must be at least 8 characters\"\n            }, {\n                status: 400\n            });\n        }\n        // Validate role\n        const validRoles = [\n            \"BUYER\",\n            \"SUPPLIER\",\n            \"CREATOR\",\n            \"AFFILIATE\"\n        ];\n        if (!validRoles.includes(role)) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Invalid role. Must be BUYER, SUPPLIER, CREATOR, or AFFILIATE\"\n            }, {\n                status: 400\n            });\n        }\n        // Check if user exists\n        const existingUser = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.user.findUnique({\n            where: {\n                email\n            }\n        });\n        if (existingUser) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"User with this email already exists\"\n            }, {\n                status: 409\n            });\n        }\n        // Hash password\n        const hashedPassword = await bcryptjs__WEBPACK_IMPORTED_MODULE_3__[\"default\"].hash(password, 10);\n        // Create user and profile in transaction\n        const result = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.$transaction(async (tx)=>{\n            // Create user\n            const user = await tx.user.create({\n                data: {\n                    email,\n                    passwordHash: hashedPassword,\n                    role: role,\n                    country: country || null,\n                    isActive: true\n                }\n            });\n            // Create role-specific profile\n            if (role === \"BUYER\") {\n                await tx.buyerProfile.create({\n                    data: {\n                        userId: user.id,\n                        companyName: profileData?.companyName,\n                        phoneNumber: profileData?.phoneNumber,\n                        defaultAddress: profileData?.address,\n                        defaultCity: profileData?.city,\n                        defaultCountry: country || \"NG\"\n                    }\n                });\n            } else if (role === \"SUPPLIER\") {\n                await tx.supplierProfile.create({\n                    data: {\n                        userId: user.id,\n                        businessName: profileData?.businessName,\n                        type: profileData?.type || \"FACTORY\",\n                        phoneNumber: profileData?.phoneNumber,\n                        address: profileData?.address,\n                        city: profileData?.city,\n                        isVerified: false\n                    }\n                });\n            } else if (role === \"CREATOR\") {\n                await tx.creatorProfile.create({\n                    data: {\n                        userId: user.id,\n                        displayName: profileData?.displayName,\n                        creatorType: profileData?.creatorType || \"GRAPHIC_DESIGNER\",\n                        bio: profileData?.bio,\n                        isVerified: false\n                    }\n                });\n            } else if (role === \"AFFILIATE\") {\n                await tx.affiliateProfile.create({\n                    data: {\n                        userId: user.id,\n                        displayName: profileData?.displayName,\n                        bio: profileData?.bio\n                    }\n                });\n            }\n            // Create wallet\n            await tx.wallet.create({\n                data: {\n                    userId: user.id,\n                    balance: 0,\n                    lockedBalance: 0,\n                    currency: \"NGN\",\n                    status: \"ACTIVE\"\n                }\n            });\n            // Store hashed password (if you have a password field, otherwise use Supabase)\n            // This implementation assumes you're using Supabase for auth\n            // If using custom auth, add a Password model\n            return user;\n        });\n        // Set JWT session\n        await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.setSession)({\n            id: result.id,\n            email: result.email,\n            role: result.role,\n            country: result.country\n        });\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            user: {\n                id: result.id,\n                email: result.email,\n                role: result.role,\n                country: result.country\n            },\n            message: \"Registration successful\"\n        }, {\n            status: 201\n        });\n    } catch (error) {\n        console.error(\"Registration error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Registration failed. Please try again.\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFDQThDLFNBQVM7UUFDYixHQUNBO1lBQUUzQyxRQUFRO1FBQUk7SUFFdEIsRUFBRSxPQUFPRCxPQUFPO1FBQ1o2QyxRQUFRN0MsS0FBSyxDQUFDLHVCQUF1QkE7UUFDckMsT0FBT2Isa0ZBQVlBLENBQUNPLElBQUksQ0FDcEI7WUFBRU0sT0FBTztRQUF5QyxHQUNsRDtZQUFFQyxRQUFRO1FBQUk7SUFFdEI7QUFDSiIsInNvdXJjZXMiOlsid2VicGFjazovL2JhbmFkYW1hLXBsYXRmb3JtLy4vYXBwL2FwaS9hdXRoL3JlZ2lzdGVyL3JvdXRlLnRzPzRhOGEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gYXBwL2FwaS9hdXRoL3JlZ2lzdGVyL3JvdXRlLnRzXHJcbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcclxuaW1wb3J0IHsgZGIgfSBmcm9tIFwiQC9saWIvZGJcIjtcclxuaW1wb3J0IHsgc2V0U2Vzc2lvbiB9IGZyb20gXCJAL2xpYi9hdXRoXCI7XHJcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XHJcbmltcG9ydCB0eXBlIHsgUm9sZSB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xyXG4gICAgICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkLCByb2xlLCBjb3VudHJ5LCBwcm9maWxlRGF0YSB9ID0gYm9keTtcclxuXHJcbiAgICAgICAgLy8gVmFsaWRhdGlvblxyXG4gICAgICAgIGlmICghZW1haWwgfHwgIXBhc3N3b3JkIHx8ICFyb2xlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgICAgICAgIHsgZXJyb3I6IFwiTWlzc2luZyByZXF1aXJlZCBmaWVsZHM6IGVtYWlsLCBwYXNzd29yZCwgcm9sZVwiIH0sXHJcbiAgICAgICAgICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEVtYWlsIHZhbGlkYXRpb25cclxuICAgICAgICBjb25zdCBlbWFpbFJlZ2V4ID0gL15bXlxcc0BdK0BbXlxcc0BdK1xcLlteXFxzQF0rJC87XHJcbiAgICAgICAgaWYgKCFlbWFpbFJlZ2V4LnRlc3QoZW1haWwpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgICAgICAgIHsgZXJyb3I6IFwiSW52YWxpZCBlbWFpbCBmb3JtYXRcIiB9LFxyXG4gICAgICAgICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBQYXNzd29yZCBzdHJlbmd0aFxyXG4gICAgICAgIGlmIChwYXNzd29yZC5sZW5ndGggPCA4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgICAgICAgIHsgZXJyb3I6IFwiUGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCA4IGNoYXJhY3RlcnNcIiB9LFxyXG4gICAgICAgICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBWYWxpZGF0ZSByb2xlXHJcbiAgICAgICAgY29uc3QgdmFsaWRSb2xlczogUm9sZVtdID0gW1wiQlVZRVJcIiwgXCJTVVBQTElFUlwiLCBcIkNSRUFUT1JcIiwgXCJBRkZJTElBVEVcIl07XHJcbiAgICAgICAgaWYgKCF2YWxpZFJvbGVzLmluY2x1ZGVzKHJvbGUgYXMgUm9sZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgICAgICAgeyBlcnJvcjogXCJJbnZhbGlkIHJvbGUuIE11c3QgYmUgQlVZRVIsIFNVUFBMSUVSLCBDUkVBVE9SLCBvciBBRkZJTElBVEVcIiB9LFxyXG4gICAgICAgICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiB1c2VyIGV4aXN0c1xyXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IGRiLnVzZXIuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGVtYWlsIH0sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChleGlzdGluZ1VzZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgICAgICAgeyBlcnJvcjogXCJVc2VyIHdpdGggdGhpcyBlbWFpbCBhbHJlYWR5IGV4aXN0c1wiIH0sXHJcbiAgICAgICAgICAgICAgICB7IHN0YXR1czogNDA5IH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEhhc2ggcGFzc3dvcmRcclxuICAgICAgICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHBhc3N3b3JkLCAxMCk7XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSB1c2VyIGFuZCBwcm9maWxlIGluIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuJHRyYW5zYWN0aW9uKGFzeW5jICh0eCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBDcmVhdGUgdXNlclxyXG4gICAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgdHgudXNlci5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkSGFzaDogaGFzaGVkUGFzc3dvcmQsXHJcbiAgICAgICAgICAgICAgICAgICAgcm9sZTogcm9sZSBhcyBSb2xlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50cnk6IGNvdW50cnkgfHwgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBpc0FjdGl2ZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gQ3JlYXRlIHJvbGUtc3BlY2lmaWMgcHJvZmlsZVxyXG4gICAgICAgICAgICBpZiAocm9sZSA9PT0gXCJCVVlFUlwiKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5idXllclByb2ZpbGUuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGFueU5hbWU6IHByb2ZpbGVEYXRhPy5jb21wYW55TmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHByb2ZpbGVEYXRhPy5waG9uZU51bWJlcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdEFkZHJlc3M6IHByb2ZpbGVEYXRhPy5hZGRyZXNzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Q2l0eTogcHJvZmlsZURhdGE/LmNpdHksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRDb3VudHJ5OiBjb3VudHJ5IHx8IFwiTkdcIixcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocm9sZSA9PT0gXCJTVVBQTElFUlwiKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5zdXBwbGllclByb2ZpbGUuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnVzaW5lc3NOYW1lOiBwcm9maWxlRGF0YT8uYnVzaW5lc3NOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBwcm9maWxlRGF0YT8udHlwZSB8fCBcIkZBQ1RPUllcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHByb2ZpbGVEYXRhPy5waG9uZU51bWJlcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzczogcHJvZmlsZURhdGE/LmFkZHJlc3MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNpdHk6IHByb2ZpbGVEYXRhPy5jaXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1ZlcmlmaWVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocm9sZSA9PT0gXCJDUkVBVE9SXCIpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmNyZWF0b3JQcm9maWxlLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHVzZXIuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBwcm9maWxlRGF0YT8uZGlzcGxheU5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0b3JUeXBlOiBwcm9maWxlRGF0YT8uY3JlYXRvclR5cGUgfHwgXCJHUkFQSElDX0RFU0lHTkVSXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJpbzogcHJvZmlsZURhdGE/LmJpbyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNWZXJpZmllZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJvbGUgPT09IFwiQUZGSUxJQVRFXCIpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHR4LmFmZmlsaWF0ZVByb2ZpbGUuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IHByb2ZpbGVEYXRhPy5kaXNwbGF5TmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmlvOiBwcm9maWxlRGF0YT8uYmlvLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gQ3JlYXRlIHdhbGxldFxyXG4gICAgICAgICAgICBhd2FpdCB0eC53YWxsZXQuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHVzZXIuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgYmFsYW5jZTogMCxcclxuICAgICAgICAgICAgICAgICAgICBsb2NrZWRCYWxhbmNlOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5OiBcIk5HTlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogXCJBQ1RJVkVcIixcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gU3RvcmUgaGFzaGVkIHBhc3N3b3JkIChpZiB5b3UgaGF2ZSBhIHBhc3N3b3JkIGZpZWxkLCBvdGhlcndpc2UgdXNlIFN1cGFiYXNlKVxyXG4gICAgICAgICAgICAvLyBUaGlzIGltcGxlbWVudGF0aW9uIGFzc3VtZXMgeW91J3JlIHVzaW5nIFN1cGFiYXNlIGZvciBhdXRoXHJcbiAgICAgICAgICAgIC8vIElmIHVzaW5nIGN1c3RvbSBhdXRoLCBhZGQgYSBQYXNzd29yZCBtb2RlbFxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHVzZXI7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFNldCBKV1Qgc2Vzc2lvblxyXG4gICAgICAgIGF3YWl0IHNldFNlc3Npb24oe1xyXG4gICAgICAgICAgICBpZDogcmVzdWx0LmlkLFxyXG4gICAgICAgICAgICBlbWFpbDogcmVzdWx0LmVtYWlsLFxyXG4gICAgICAgICAgICByb2xlOiByZXN1bHQucm9sZSxcclxuICAgICAgICAgICAgY291bnRyeTogcmVzdWx0LmNvdW50cnksXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHVzZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICBpZDogcmVzdWx0LmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiByZXN1bHQuZW1haWwsXHJcbiAgICAgICAgICAgICAgICAgICAgcm9sZTogcmVzdWx0LnJvbGUsXHJcbiAgICAgICAgICAgICAgICAgICAgY291bnRyeTogcmVzdWx0LmNvdW50cnksXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJSZWdpc3RyYXRpb24gc3VjY2Vzc2Z1bFwiLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7IHN0YXR1czogMjAxIH1cclxuICAgICAgICApO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiUmVnaXN0cmF0aW9uIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgICB7IGVycm9yOiBcIlJlZ2lzdHJhdGlvbiBmYWlsZWQuIFBsZWFzZSB0cnkgYWdhaW4uXCIgfSxcclxuICAgICAgICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZGIiLCJzZXRTZXNzaW9uIiwiYmNyeXB0IiwiUE9TVCIsInJlcXVlc3QiLCJib2R5IiwianNvbiIsImVtYWlsIiwicGFzc3dvcmQiLCJyb2xlIiwiY291bnRyeSIsInByb2ZpbGVEYXRhIiwiZXJyb3IiLCJzdGF0dXMiLCJlbWFpbFJlZ2V4IiwidGVzdCIsImxlbmd0aCIsInZhbGlkUm9sZXMiLCJpbmNsdWRlcyIsImV4aXN0aW5nVXNlciIsInVzZXIiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJoYXNoZWRQYXNzd29yZCIsImhhc2giLCJyZXN1bHQiLCIkdHJhbnNhY3Rpb24iLCJ0eCIsImNyZWF0ZSIsImRhdGEiLCJwYXNzd29yZEhhc2giLCJpc0FjdGl2ZSIsImJ1eWVyUHJvZmlsZSIsInVzZXJJZCIsImlkIiwiY29tcGFueU5hbWUiLCJwaG9uZU51bWJlciIsImRlZmF1bHRBZGRyZXNzIiwiYWRkcmVzcyIsImRlZmF1bHRDaXR5IiwiY2l0eSIsImRlZmF1bHRDb3VudHJ5Iiwic3VwcGxpZXJQcm9maWxlIiwiYnVzaW5lc3NOYW1lIiwidHlwZSIsImlzVmVyaWZpZWQiLCJjcmVhdG9yUHJvZmlsZSIsImRpc3BsYXlOYW1lIiwiY3JlYXRvclR5cGUiLCJiaW8iLCJhZmZpbGlhdGVQcm9maWxlIiwid2FsbGV0IiwiYmFsYW5jZSIsImxvY2tlZEJhbGFuY2UiLCJjdXJyZW5jeSIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/register/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearSession: () => (/* binding */ clearSession),\n/* harmony export */   getAllowedRoutesForRole: () => (/* binding */ getAllowedRoutesForRole),\n/* harmony export */   getApiUser: () => (/* binding */ getApiUser),\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser),\n/* harmony export */   getRoleDashboard: () => (/* binding */ getRoleDashboard),\n/* harmony export */   hasRole: () => (/* binding */ hasRole),\n/* harmony export */   isPublicRoute: () => (/* binding */ isPublicRoute),\n/* harmony export */   refreshSession: () => (/* binding */ refreshSession),\n/* harmony export */   requireApiRole: () => (/* binding */ requireApiRole),\n/* harmony export */   requireAuth: () => (/* binding */ requireAuth),\n/* harmony export */   requireRole: () => (/* binding */ requireRole),\n/* harmony export */   setSession: () => (/* binding */ setSession)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/.pnpm/next@14.0.0_@babel+core@7.2_d581c8e324c8c8e93d52c4758017b76b/node_modules/next/headers.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_headers__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_navigation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/navigation */ \"(rsc)/./node_modules/.pnpm/next@14.0.0_@babel+core@7.2_d581c8e324c8c8e93d52c4758017b76b/node_modules/next/navigation.js\");\n/* harmony import */ var next_navigation__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_navigation__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@6.1.3/node_modules/jose/dist/webapi/jwt/sign.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/.pnpm/jose@6.1.3/node_modules/jose/dist/webapi/jwt/verify.js\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./db */ \"(rsc)/./lib/db.ts\");\n// lib/auth.ts - Complete Authentication System\n// Implements JWT httpOnly cookies + RBAC\n\n\n\n\n// ============================================\n// JWT CONFIGURATION\n// ============================================\nconst JWT_SECRET = new TextEncoder().encode(process.env.JWT_SECRET || \"your-super-secret-jwt-key-change-in-production\");\nconst JWT_COOKIE_NAME = \"banadama-session\";\nconst JWT_EXPIRY = \"7d\"; // 7 days\n// ============================================\n// SESSION MANAGEMENT\n// ============================================\n/**\r\n * Set session using JWT httpOnly cookie\r\n * \r\n * @param user - User data to encode in JWT\r\n * @returns JWT token string\r\n * \r\n * @example\r\n * ```ts\r\n * await setSession({ id: '123', email: 'user@example.com', role: 'BUYER' });\r\n * ```\r\n */ async function setSession(user) {\n    try {\n        // Create JWT payload\n        const payload = {\n            userId: user.id,\n            email: user.email,\n            role: user.role,\n            country: user.country\n        };\n        // Sign JWT\n        const token = await new jose__WEBPACK_IMPORTED_MODULE_3__.SignJWT(payload).setProtectedHeader({\n            alg: \"HS256\"\n        }).setIssuedAt().setExpirationTime(JWT_EXPIRY).sign(JWT_SECRET);\n        // Set httpOnly cookie\n        const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n        cookieStore.set({\n            name: JWT_COOKIE_NAME,\n            value: token,\n            httpOnly: true,\n            secure: \"development\" === \"production\",\n            sameSite: \"lax\",\n            maxAge: 60 * 60 * 24 * 7,\n            path: \"/\"\n        });\n        return token;\n    } catch (error) {\n        console.error(\"Error setting session:\", error);\n        throw new Error(\"Failed to create session\");\n    }\n}\n/**\r\n * Get current user from JWT cookie\r\n * \r\n * @returns AuthUser or null if not authenticated\r\n */ async function getCurrentUser() {\n    try {\n        const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n        const token = cookieStore.get(JWT_COOKIE_NAME)?.value;\n        if (!token) {\n            return null;\n        }\n        // Verify and decode JWT\n        const { payload } = await (0,jose__WEBPACK_IMPORTED_MODULE_4__.jwtVerify)(token, JWT_SECRET);\n        const session = payload;\n        if (!session.userId || !session.email) {\n            return null;\n        }\n        // Fetch fresh user data from database\n        const user = await _db__WEBPACK_IMPORTED_MODULE_2__.db.user.findUnique({\n            where: {\n                id: session.userId\n            },\n            select: {\n                id: true,\n                email: true,\n                role: true,\n                country: true,\n                isActive: true\n            }\n        });\n        if (!user || !user.isActive) {\n            // User doesn't exist or is deactivated\n            await clearSession();\n            return null;\n        }\n        return {\n            id: user.id,\n            email: user.email,\n            role: user.role,\n            country: user.country\n        };\n    } catch (error) {\n        // JWT verification failed or expired\n        console.error(\"Error getting current user:\", error);\n        return null;\n    }\n}\n/**\r\n * Clear session (logout)\r\n */ async function clearSession() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    cookieStore.delete(JWT_COOKIE_NAME);\n}\n/**\r\n * Refresh session (extend expiry)\r\n */ async function refreshSession() {\n    const user = await getCurrentUser();\n    if (user) {\n        await setSession(user);\n    }\n}\n// ============================================\n// ROLE-BASED ACCESS CONTROL\n// ============================================\n/**\r\n * Require specific role(s) for access\r\n * Redirects if not authenticated or wrong role\r\n * \r\n * @param allowed - Single role or array of allowed roles\r\n * @returns Authenticated user if authorized\r\n * @throws Redirects to /auth/login if not authenticated\r\n * @throws Redirects to /auth/forbidden if wrong role\r\n * \r\n * @example\r\n * ```ts\r\n * // Single role\r\n * await requireRole('BUYER');\r\n * \r\n * // Multiple roles\r\n * await requireRole(['ADMIN', 'OPS']);\r\n * \r\n * // Get user data\r\n * const user = await requireRole('ADMIN');\r\n * console.log(user.email);\r\n * ```\r\n */ async function requireRole(allowed) {\n    const roles = Array.isArray(allowed) ? allowed : [\n        allowed\n    ];\n    const user = await getCurrentUser();\n    if (!user) {\n        (0,next_navigation__WEBPACK_IMPORTED_MODULE_1__.redirect)(\"/auth/login\");\n    }\n    // Handle legacy roles (FACTORY, WHOLESALER â†’ SUPPLIER)\n    const normalizedUserRole = normalizeRole(user.role);\n    const normalizedAllowedRoles = roles.map(normalizeRole);\n    if (!normalizedAllowedRoles.includes(normalizedUserRole)) {\n        (0,next_navigation__WEBPACK_IMPORTED_MODULE_1__.redirect)(\"/auth/forbidden\");\n    }\n    return user;\n}\n/**\r\n * Require any authenticated user (any role)\r\n * \r\n * @returns Authenticated user\r\n * @throws Redirects to /auth/login if not authenticated\r\n */ async function requireAuth() {\n    const user = await getCurrentUser();\n    if (!user) {\n        (0,next_navigation__WEBPACK_IMPORTED_MODULE_1__.redirect)(\"/auth/login\");\n    }\n    return user;\n}\n/**\r\n * Check if user has specific role (non-throwing)\r\n * \r\n * @param user - User to check\r\n * @param allowed - Allowed role(s)\r\n * @returns true if user has allowed role\r\n */ function hasRole(user, allowed) {\n    if (!user) return false;\n    const roles = Array.isArray(allowed) ? allowed : [\n        allowed\n    ];\n    const normalizedUserRole = normalizeRole(user.role);\n    const normalizedAllowedRoles = roles.map(normalizeRole);\n    return normalizedAllowedRoles.includes(normalizedUserRole);\n}\n/**\r\n * Normalize legacy roles to SUPPLIER\r\n */ function normalizeRole(role) {\n    if (role === \"FACTORY\" || role === \"WHOLESALER\") {\n        return \"SUPPLIER\";\n    }\n    return role;\n}\n// ============================================\n// API ROUTE HELPERS\n// ============================================\n/**\r\n * Get current user for API routes (doesn't redirect)\r\n * Returns null if not authenticated\r\n */ async function getApiUser() {\n    return getCurrentUser();\n}\n/**\r\n * Require role for API routes (returns error instead of redirect)\r\n * \r\n * @example\r\n * ```ts\r\n * const { user, error } = await requireApiRole('ADMIN');\r\n * if (error) {\r\n *   return NextResponse.json({ error: error.message }, { status: error.status });\r\n * }\r\n * ```\r\n */ async function requireApiRole(allowed) {\n    const user = await getCurrentUser();\n    if (!user) {\n        return {\n            error: {\n                message: \"Unauthorized\",\n                status: 401\n            }\n        };\n    }\n    const roles = Array.isArray(allowed) ? allowed : [\n        allowed\n    ];\n    const normalizedUserRole = normalizeRole(user.role);\n    const normalizedAllowedRoles = roles.map(normalizeRole);\n    if (!normalizedAllowedRoles.includes(normalizedUserRole)) {\n        return {\n            error: {\n                message: \"Forbidden\",\n                status: 403\n            }\n        };\n    }\n    return {\n        user\n    };\n}\n// ============================================\n// UTILITY FUNCTIONS\n// ============================================\n/**\r\n * Get role-based dashboard URL\r\n */ function getRoleDashboard(role) {\n    const normalized = normalizeRole(role);\n    const dashboards = {\n        BUYER: \"/buyer/dashboard\",\n        SUPPLIER: \"/factory/dashboard\",\n        FACTORY: \"/factory/dashboard\",\n        WHOLESALER: \"/wholesaler/dashboard\",\n        CREATOR: \"/creator/dashboard\",\n        OPS: \"/ops/overview\",\n        AFFILIATE: \"/affiliate/dashboard\",\n        ADMIN: \"/admin/overview\"\n    };\n    return dashboards[role] || \"/\";\n}\n/**\r\n * Check if route is public (doesn't require auth)\r\n */ function isPublicRoute(pathname) {\n    const publicPaths = [\n        \"/\",\n        \"/auth/login\",\n        \"/auth/register\",\n        \"/auth/forgot-password\",\n        \"/marketplace\",\n        \"/buy-near-me\",\n        \"/global-market\",\n        \"/group-buy\",\n        \"/creators\",\n        \"/affiliate\",\n        \"/api/auth\"\n    ];\n    return publicPaths.some((path)=>pathname.startsWith(path));\n}\n/**\r\n * Get allowed routes for a role\r\n */ function getAllowedRoutesForRole(role) {\n    const normalized = normalizeRole(role);\n    const routes = {\n        BUYER: [\n            \"/buyer\"\n        ],\n        SUPPLIER: [\n            \"/supplier\"\n        ],\n        FACTORY: [\n            \"/supplier\"\n        ],\n        WHOLESALER: [\n            \"/supplier\"\n        ],\n        CREATOR: [\n            \"/creator\"\n        ],\n        OPS: [\n            \"/ops\"\n        ],\n        AFFILIATE: [\n            \"/affiliate\"\n        ],\n        ADMIN: [\n            \"/admin\",\n            \"/ops\"\n        ]\n    };\n    return routes[normalized] || [];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1FBQ0E7UUFDQTtLQUNIO0lBRUQsT0FBT0EsWUFBWUMsSUFBSSxDQUFDLENBQUM1QyxPQUFTMEMsU0FBU0csVUFBVSxDQUFDN0M7QUFDMUQ7QUFFQTs7Q0FFQyxHQUNNLFNBQVM4Qyx3QkFBd0I5RCxJQUFVO0lBQzlDLE1BQU0rQyxhQUFhWCxjQUFjcEM7SUFFakMsTUFBTStELFNBQWlDO1FBQ25DZCxPQUFPO1lBQUM7U0FBUztRQUNqQkMsVUFBVTtZQUFDO1NBQVk7UUFDdkJDLFNBQVM7WUFBQztTQUFZO1FBQ3RCQyxZQUFZO1lBQUM7U0FBWTtRQUN6QkMsU0FBUztZQUFDO1NBQVc7UUFDckJDLEtBQUs7WUFBQztTQUFPO1FBQ2JDLFdBQVc7WUFBQztTQUFhO1FBQ3pCQyxPQUFPO1lBQUM7WUFBVTtTQUFPO0lBQzdCO0lBRUEsT0FBT08sTUFBTSxDQUFDaEIsV0FBVyxJQUFJLEVBQUU7QUFDbkMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYW5hZGFtYS1wbGF0Zm9ybS8uL2xpYi9hdXRoLnRzP2JmN2UiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGliL2F1dGgudHMgLSBDb21wbGV0ZSBBdXRoZW50aWNhdGlvbiBTeXN0ZW1cclxuLy8gSW1wbGVtZW50cyBKV1QgaHR0cE9ubHkgY29va2llcyArIFJCQUNcclxuXHJcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tIFwibmV4dC9oZWFkZXJzXCI7XHJcbmltcG9ydCB7IHJlZGlyZWN0IH0gZnJvbSBcIm5leHQvbmF2aWdhdGlvblwiO1xyXG5pbXBvcnQgeyBTaWduSldULCBqd3RWZXJpZnkgfSBmcm9tIFwiam9zZVwiO1xyXG5pbXBvcnQgeyBkYiB9IGZyb20gXCIuL2RiXCI7XHJcbmltcG9ydCB0eXBlIHsgUm9sZSB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gVFlQRVNcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQXV0aFVzZXIge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIGVtYWlsOiBzdHJpbmc7XHJcbiAgICByb2xlOiBSb2xlO1xyXG4gICAgY291bnRyeT86IHN0cmluZyB8IG51bGw7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2Vzc2lvblBheWxvYWQge1xyXG4gICAgdXNlcklkOiBzdHJpbmc7XHJcbiAgICBlbWFpbDogc3RyaW5nO1xyXG4gICAgcm9sZTogUm9sZTtcclxuICAgIGNvdW50cnk/OiBzdHJpbmcgfCBudWxsO1xyXG4gICAgaWF0PzogbnVtYmVyO1xyXG4gICAgZXhwPzogbnVtYmVyO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBKV1QgQ09ORklHVVJBVElPTlxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuY29uc3QgSldUX1NFQ1JFVCA9IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShcclxuICAgIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQgfHwgXCJ5b3VyLXN1cGVyLXNlY3JldC1qd3Qta2V5LWNoYW5nZS1pbi1wcm9kdWN0aW9uXCJcclxuKTtcclxuXHJcbmNvbnN0IEpXVF9DT09LSUVfTkFNRSA9IFwiYmFuYWRhbWEtc2Vzc2lvblwiO1xyXG5jb25zdCBKV1RfRVhQSVJZID0gXCI3ZFwiOyAvLyA3IGRheXNcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFNFU1NJT04gTUFOQUdFTUVOVFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIFNldCBzZXNzaW9uIHVzaW5nIEpXVCBodHRwT25seSBjb29raWVcclxuICogXHJcbiAqIEBwYXJhbSB1c2VyIC0gVXNlciBkYXRhIHRvIGVuY29kZSBpbiBKV1RcclxuICogQHJldHVybnMgSldUIHRva2VuIHN0cmluZ1xyXG4gKiBcclxuICogQGV4YW1wbGVcclxuICogYGBgdHNcclxuICogYXdhaXQgc2V0U2Vzc2lvbih7IGlkOiAnMTIzJywgZW1haWw6ICd1c2VyQGV4YW1wbGUuY29tJywgcm9sZTogJ0JVWUVSJyB9KTtcclxuICogYGBgXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0U2Vzc2lvbih1c2VyOiBBdXRoVXNlcik6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIC8vIENyZWF0ZSBKV1QgcGF5bG9hZFxyXG4gICAgICAgIGNvbnN0IHBheWxvYWQ6IFNlc3Npb25QYXlsb2FkID0ge1xyXG4gICAgICAgICAgICB1c2VySWQ6IHVzZXIuaWQsXHJcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxyXG4gICAgICAgICAgICByb2xlOiB1c2VyLnJvbGUsXHJcbiAgICAgICAgICAgIGNvdW50cnk6IHVzZXIuY291bnRyeSxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBTaWduIEpXVFxyXG4gICAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgbmV3IFNpZ25KV1QocGF5bG9hZClcclxuICAgICAgICAgICAgLnNldFByb3RlY3RlZEhlYWRlcih7IGFsZzogXCJIUzI1NlwiIH0pXHJcbiAgICAgICAgICAgIC5zZXRJc3N1ZWRBdCgpXHJcbiAgICAgICAgICAgIC5zZXRFeHBpcmF0aW9uVGltZShKV1RfRVhQSVJZKVxyXG4gICAgICAgICAgICAuc2lnbihKV1RfU0VDUkVUKTtcclxuXHJcbiAgICAgICAgLy8gU2V0IGh0dHBPbmx5IGNvb2tpZVxyXG4gICAgICAgIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpO1xyXG4gICAgICAgIGNvb2tpZVN0b3JlLnNldCh7XHJcbiAgICAgICAgICAgIG5hbWU6IEpXVF9DT09LSUVfTkFNRSxcclxuICAgICAgICAgICAgdmFsdWU6IHRva2VuLFxyXG4gICAgICAgICAgICBodHRwT25seTogdHJ1ZSxcclxuICAgICAgICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJwcm9kdWN0aW9uXCIsXHJcbiAgICAgICAgICAgIHNhbWVTaXRlOiBcImxheFwiLFxyXG4gICAgICAgICAgICBtYXhBZ2U6IDYwICogNjAgKiAyNCAqIDcsIC8vIDcgZGF5c1xyXG4gICAgICAgICAgICBwYXRoOiBcIi9cIixcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRva2VuO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2V0dGluZyBzZXNzaW9uOlwiLCBlcnJvcik7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBzZXNzaW9uXCIpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IGN1cnJlbnQgdXNlciBmcm9tIEpXVCBjb29raWVcclxuICogXHJcbiAqIEByZXR1cm5zIEF1dGhVc2VyIG9yIG51bGwgaWYgbm90IGF1dGhlbnRpY2F0ZWRcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcigpOiBQcm9taXNlPEF1dGhVc2VyIHwgbnVsbD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKTtcclxuICAgICAgICBjb25zdCB0b2tlbiA9IGNvb2tpZVN0b3JlLmdldChKV1RfQ09PS0lFX05BTUUpPy52YWx1ZTtcclxuXHJcbiAgICAgICAgaWYgKCF0b2tlbikge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFZlcmlmeSBhbmQgZGVjb2RlIEpXVFxyXG4gICAgICAgIGNvbnN0IHsgcGF5bG9hZCB9ID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBKV1RfU0VDUkVUKTtcclxuICAgICAgICBjb25zdCBzZXNzaW9uID0gcGF5bG9hZCBhcyBTZXNzaW9uUGF5bG9hZDtcclxuXHJcbiAgICAgICAgaWYgKCFzZXNzaW9uLnVzZXJJZCB8fCAhc2Vzc2lvbi5lbWFpbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEZldGNoIGZyZXNoIHVzZXIgZGF0YSBmcm9tIGRhdGFiYXNlXHJcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGRiLnVzZXIuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBzZXNzaW9uLnVzZXJJZCB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IHtcclxuICAgICAgICAgICAgICAgIGlkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZW1haWw6IHRydWUsXHJcbiAgICAgICAgICAgICAgICByb2xlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgY291bnRyeTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGlzQWN0aXZlOiB0cnVlLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIXVzZXIgfHwgIXVzZXIuaXNBY3RpdmUpIHtcclxuICAgICAgICAgICAgLy8gVXNlciBkb2Vzbid0IGV4aXN0IG9yIGlzIGRlYWN0aXZhdGVkXHJcbiAgICAgICAgICAgIGF3YWl0IGNsZWFyU2Vzc2lvbigpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGlkOiB1c2VyLmlkLFxyXG4gICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcclxuICAgICAgICAgICAgcm9sZTogdXNlci5yb2xlLFxyXG4gICAgICAgICAgICBjb3VudHJ5OiB1c2VyLmNvdW50cnksXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgLy8gSldUIHZlcmlmaWNhdGlvbiBmYWlsZWQgb3IgZXhwaXJlZFxyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBnZXR0aW5nIGN1cnJlbnQgdXNlcjpcIiwgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ2xlYXIgc2Vzc2lvbiAobG9nb3V0KVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFyU2Vzc2lvbigpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpO1xyXG4gICAgY29va2llU3RvcmUuZGVsZXRlKEpXVF9DT09LSUVfTkFNRSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZWZyZXNoIHNlc3Npb24gKGV4dGVuZCBleHBpcnkpXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVmcmVzaFNlc3Npb24oKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0Q3VycmVudFVzZXIoKTtcclxuICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbih1c2VyKTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gUk9MRS1CQVNFRCBBQ0NFU1MgQ09OVFJPTFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIFJlcXVpcmUgc3BlY2lmaWMgcm9sZShzKSBmb3IgYWNjZXNzXHJcbiAqIFJlZGlyZWN0cyBpZiBub3QgYXV0aGVudGljYXRlZCBvciB3cm9uZyByb2xlXHJcbiAqIFxyXG4gKiBAcGFyYW0gYWxsb3dlZCAtIFNpbmdsZSByb2xlIG9yIGFycmF5IG9mIGFsbG93ZWQgcm9sZXNcclxuICogQHJldHVybnMgQXV0aGVudGljYXRlZCB1c2VyIGlmIGF1dGhvcml6ZWRcclxuICogQHRocm93cyBSZWRpcmVjdHMgdG8gL2F1dGgvbG9naW4gaWYgbm90IGF1dGhlbnRpY2F0ZWRcclxuICogQHRocm93cyBSZWRpcmVjdHMgdG8gL2F1dGgvZm9yYmlkZGVuIGlmIHdyb25nIHJvbGVcclxuICogXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYHRzXHJcbiAqIC8vIFNpbmdsZSByb2xlXHJcbiAqIGF3YWl0IHJlcXVpcmVSb2xlKCdCVVlFUicpO1xyXG4gKiBcclxuICogLy8gTXVsdGlwbGUgcm9sZXNcclxuICogYXdhaXQgcmVxdWlyZVJvbGUoWydBRE1JTicsICdPUFMnXSk7XHJcbiAqIFxyXG4gKiAvLyBHZXQgdXNlciBkYXRhXHJcbiAqIGNvbnN0IHVzZXIgPSBhd2FpdCByZXF1aXJlUm9sZSgnQURNSU4nKTtcclxuICogY29uc29sZS5sb2codXNlci5lbWFpbCk7XHJcbiAqIGBgYFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVSb2xlKFxyXG4gICAgYWxsb3dlZDogUm9sZSB8IFJvbGVbXVxyXG4pOiBQcm9taXNlPEF1dGhVc2VyPiB7XHJcbiAgICBjb25zdCByb2xlcyA9IEFycmF5LmlzQXJyYXkoYWxsb3dlZCkgPyBhbGxvd2VkIDogW2FsbG93ZWRdO1xyXG5cclxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBnZXRDdXJyZW50VXNlcigpO1xyXG5cclxuICAgIGlmICghdXNlcikge1xyXG4gICAgICAgIHJlZGlyZWN0KFwiL2F1dGgvbG9naW5cIik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSGFuZGxlIGxlZ2FjeSByb2xlcyAoRkFDVE9SWSwgV0hPTEVTQUxFUiDihpIgU1VQUExJRVIpXHJcbiAgICBjb25zdCBub3JtYWxpemVkVXNlclJvbGUgPSBub3JtYWxpemVSb2xlKHVzZXIucm9sZSk7XHJcbiAgICBjb25zdCBub3JtYWxpemVkQWxsb3dlZFJvbGVzID0gcm9sZXMubWFwKG5vcm1hbGl6ZVJvbGUpO1xyXG5cclxuICAgIGlmICghbm9ybWFsaXplZEFsbG93ZWRSb2xlcy5pbmNsdWRlcyhub3JtYWxpemVkVXNlclJvbGUpKSB7XHJcbiAgICAgICAgcmVkaXJlY3QoXCIvYXV0aC9mb3JiaWRkZW5cIik7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHVzZXI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXF1aXJlIGFueSBhdXRoZW50aWNhdGVkIHVzZXIgKGFueSByb2xlKVxyXG4gKiBcclxuICogQHJldHVybnMgQXV0aGVudGljYXRlZCB1c2VyXHJcbiAqIEB0aHJvd3MgUmVkaXJlY3RzIHRvIC9hdXRoL2xvZ2luIGlmIG5vdCBhdXRoZW50aWNhdGVkXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZUF1dGgoKTogUHJvbWlzZTxBdXRoVXNlcj4ge1xyXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGdldEN1cnJlbnRVc2VyKCk7XHJcblxyXG4gICAgaWYgKCF1c2VyKSB7XHJcbiAgICAgICAgcmVkaXJlY3QoXCIvYXV0aC9sb2dpblwiKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdXNlcjtcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIHVzZXIgaGFzIHNwZWNpZmljIHJvbGUgKG5vbi10aHJvd2luZylcclxuICogXHJcbiAqIEBwYXJhbSB1c2VyIC0gVXNlciB0byBjaGVja1xyXG4gKiBAcGFyYW0gYWxsb3dlZCAtIEFsbG93ZWQgcm9sZShzKVxyXG4gKiBAcmV0dXJucyB0cnVlIGlmIHVzZXIgaGFzIGFsbG93ZWQgcm9sZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGhhc1JvbGUoXHJcbiAgICB1c2VyOiBBdXRoVXNlciB8IG51bGwsXHJcbiAgICBhbGxvd2VkOiBSb2xlIHwgUm9sZVtdXHJcbik6IGJvb2xlYW4ge1xyXG4gICAgaWYgKCF1c2VyKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgY29uc3Qgcm9sZXMgPSBBcnJheS5pc0FycmF5KGFsbG93ZWQpID8gYWxsb3dlZCA6IFthbGxvd2VkXTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRVc2VyUm9sZSA9IG5vcm1hbGl6ZVJvbGUodXNlci5yb2xlKTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRBbGxvd2VkUm9sZXMgPSByb2xlcy5tYXAobm9ybWFsaXplUm9sZSk7XHJcblxyXG4gICAgcmV0dXJuIG5vcm1hbGl6ZWRBbGxvd2VkUm9sZXMuaW5jbHVkZXMobm9ybWFsaXplZFVzZXJSb2xlKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE5vcm1hbGl6ZSBsZWdhY3kgcm9sZXMgdG8gU1VQUExJRVJcclxuICovXHJcbmZ1bmN0aW9uIG5vcm1hbGl6ZVJvbGUocm9sZTogUm9sZSk6IFJvbGUge1xyXG4gICAgaWYgKHJvbGUgPT09IFwiRkFDVE9SWVwiIHx8IHJvbGUgPT09IFwiV0hPTEVTQUxFUlwiKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiU1VQUExJRVJcIjtcclxuICAgIH1cclxuICAgIHJldHVybiByb2xlO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBBUEkgUk9VVEUgSEVMUEVSU1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEdldCBjdXJyZW50IHVzZXIgZm9yIEFQSSByb3V0ZXMgKGRvZXNuJ3QgcmVkaXJlY3QpXHJcbiAqIFJldHVybnMgbnVsbCBpZiBub3QgYXV0aGVudGljYXRlZFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFwaVVzZXIoKTogUHJvbWlzZTxBdXRoVXNlciB8IG51bGw+IHtcclxuICAgIHJldHVybiBnZXRDdXJyZW50VXNlcigpO1xyXG59XHJcblxyXG4vKipcclxuICogUmVxdWlyZSByb2xlIGZvciBBUEkgcm91dGVzIChyZXR1cm5zIGVycm9yIGluc3RlYWQgb2YgcmVkaXJlY3QpXHJcbiAqIFxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGB0c1xyXG4gKiBjb25zdCB7IHVzZXIsIGVycm9yIH0gPSBhd2FpdCByZXF1aXJlQXBpUm9sZSgnQURNSU4nKTtcclxuICogaWYgKGVycm9yKSB7XHJcbiAqICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IGVycm9yLnN0YXR1cyB9KTtcclxuICogfVxyXG4gKiBgYGBcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlQXBpUm9sZShcclxuICAgIGFsbG93ZWQ6IFJvbGUgfCBSb2xlW11cclxuKTogUHJvbWlzZTx7IHVzZXI/OiBBdXRoVXNlcjsgZXJyb3I/OiB7IG1lc3NhZ2U6IHN0cmluZzsgc3RhdHVzOiBudW1iZXIgfSB9PiB7XHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0Q3VycmVudFVzZXIoKTtcclxuXHJcbiAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiBcIlVuYXV0aG9yaXplZFwiLCBzdGF0dXM6IDQwMSB9LFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgcm9sZXMgPSBBcnJheS5pc0FycmF5KGFsbG93ZWQpID8gYWxsb3dlZCA6IFthbGxvd2VkXTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRVc2VyUm9sZSA9IG5vcm1hbGl6ZVJvbGUodXNlci5yb2xlKTtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRBbGxvd2VkUm9sZXMgPSByb2xlcy5tYXAobm9ybWFsaXplUm9sZSk7XHJcblxyXG4gICAgaWYgKCFub3JtYWxpemVkQWxsb3dlZFJvbGVzLmluY2x1ZGVzKG5vcm1hbGl6ZWRVc2VyUm9sZSkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiBcIkZvcmJpZGRlblwiLCBzdGF0dXM6IDQwMyB9LFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHsgdXNlciB9O1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBVVElMSVRZIEZVTkNUSU9OU1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEdldCByb2xlLWJhc2VkIGRhc2hib2FyZCBVUkxcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSb2xlRGFzaGJvYXJkKHJvbGU6IFJvbGUpOiBzdHJpbmcge1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZVJvbGUocm9sZSk7XHJcblxyXG4gICAgY29uc3QgZGFzaGJvYXJkczogUmVjb3JkPFJvbGUsIHN0cmluZz4gPSB7XHJcbiAgICAgICAgQlVZRVI6IFwiL2J1eWVyL2Rhc2hib2FyZFwiLFxyXG4gICAgICAgIFNVUFBMSUVSOiBcIi9mYWN0b3J5L2Rhc2hib2FyZFwiLCAvLyBEZWZhdWx0IHN1cHBsaWVycyB0byBmYWN0b3J5XHJcbiAgICAgICAgRkFDVE9SWTogXCIvZmFjdG9yeS9kYXNoYm9hcmRcIixcclxuICAgICAgICBXSE9MRVNBTEVSOiBcIi93aG9sZXNhbGVyL2Rhc2hib2FyZFwiLFxyXG4gICAgICAgIENSRUFUT1I6IFwiL2NyZWF0b3IvZGFzaGJvYXJkXCIsXHJcbiAgICAgICAgT1BTOiBcIi9vcHMvb3ZlcnZpZXdcIixcclxuICAgICAgICBBRkZJTElBVEU6IFwiL2FmZmlsaWF0ZS9kYXNoYm9hcmRcIixcclxuICAgICAgICBBRE1JTjogXCIvYWRtaW4vb3ZlcnZpZXdcIixcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIGRhc2hib2FyZHNbcm9sZV0gfHwgXCIvXCI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiByb3V0ZSBpcyBwdWJsaWMgKGRvZXNuJ3QgcmVxdWlyZSBhdXRoKVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzUHVibGljUm91dGUocGF0aG5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgcHVibGljUGF0aHMgPSBbXHJcbiAgICAgICAgXCIvXCIsXHJcbiAgICAgICAgXCIvYXV0aC9sb2dpblwiLFxyXG4gICAgICAgIFwiL2F1dGgvcmVnaXN0ZXJcIixcclxuICAgICAgICBcIi9hdXRoL2ZvcmdvdC1wYXNzd29yZFwiLFxyXG4gICAgICAgIFwiL21hcmtldHBsYWNlXCIsXHJcbiAgICAgICAgXCIvYnV5LW5lYXItbWVcIixcclxuICAgICAgICBcIi9nbG9iYWwtbWFya2V0XCIsXHJcbiAgICAgICAgXCIvZ3JvdXAtYnV5XCIsXHJcbiAgICAgICAgXCIvY3JlYXRvcnNcIixcclxuICAgICAgICBcIi9hZmZpbGlhdGVcIixcclxuICAgICAgICBcIi9hcGkvYXV0aFwiLFxyXG4gICAgXTtcclxuXHJcbiAgICByZXR1cm4gcHVibGljUGF0aHMuc29tZSgocGF0aCkgPT4gcGF0aG5hbWUuc3RhcnRzV2l0aChwYXRoKSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYWxsb3dlZCByb3V0ZXMgZm9yIGEgcm9sZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEFsbG93ZWRSb3V0ZXNGb3JSb2xlKHJvbGU6IFJvbGUpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCBub3JtYWxpemVkID0gbm9ybWFsaXplUm9sZShyb2xlKTtcclxuXHJcbiAgICBjb25zdCByb3V0ZXM6IFJlY29yZDxSb2xlLCBzdHJpbmdbXT4gPSB7XHJcbiAgICAgICAgQlVZRVI6IFtcIi9idXllclwiXSxcclxuICAgICAgICBTVVBQTElFUjogW1wiL3N1cHBsaWVyXCJdLFxyXG4gICAgICAgIEZBQ1RPUlk6IFtcIi9zdXBwbGllclwiXSxcclxuICAgICAgICBXSE9MRVNBTEVSOiBbXCIvc3VwcGxpZXJcIl0sXHJcbiAgICAgICAgQ1JFQVRPUjogW1wiL2NyZWF0b3JcIl0sXHJcbiAgICAgICAgT1BTOiBbXCIvb3BzXCJdLFxyXG4gICAgICAgIEFGRklMSUFURTogW1wiL2FmZmlsaWF0ZVwiXSxcclxuICAgICAgICBBRE1JTjogW1wiL2FkbWluXCIsIFwiL29wc1wiXSwgLy8gQWRtaW4gY2FuIGFjY2VzcyBldmVyeXRoaW5nXHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiByb3V0ZXNbbm9ybWFsaXplZF0gfHwgW107XHJcbn1cclxuIl0sIm5hbWVzIjpbImNvb2tpZXMiLCJyZWRpcmVjdCIsIlNpZ25KV1QiLCJqd3RWZXJpZnkiLCJkYiIsIkpXVF9TRUNSRVQiLCJUZXh0RW5jb2RlciIsImVuY29kZSIsInByb2Nlc3MiLCJlbnYiLCJKV1RfQ09PS0lFX05BTUUiLCJKV1RfRVhQSVJZIiwic2V0U2Vzc2lvbiIsInVzZXIiLCJwYXlsb2FkIiwidXNlcklkIiwiaWQiLCJlbWFpbCIsInJvbGUiLCJjb3VudHJ5IiwidG9rZW4iLCJzZXRQcm90ZWN0ZWRIZWFkZXIiLCJhbGciLCJzZXRJc3N1ZWRBdCIsInNldEV4cGlyYXRpb25UaW1lIiwic2lnbiIsImNvb2tpZVN0b3JlIiwic2V0IiwibmFtZSIsInZhbHVlIiwiaHR0cE9ubHkiLCJzZWN1cmUiLCJzYW1lU2l0ZSIsIm1heEFnZSIsInBhdGgiLCJlcnJvciIsImNvbnNvbGUiLCJFcnJvciIsImdldEN1cnJlbnRVc2VyIiwiZ2V0Iiwic2Vzc2lvbiIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsInNlbGVjdCIsImlzQWN0aXZlIiwiY2xlYXJTZXNzaW9uIiwiZGVsZXRlIiwicmVmcmVzaFNlc3Npb24iLCJyZXF1aXJlUm9sZSIsImFsbG93ZWQiLCJyb2xlcyIsIkFycmF5IiwiaXNBcnJheSIsIm5vcm1hbGl6ZWRVc2VyUm9sZSIsIm5vcm1hbGl6ZVJvbGUiLCJub3JtYWxpemVkQWxsb3dlZFJvbGVzIiwibWFwIiwiaW5jbHVkZXMiLCJyZXF1aXJlQXV0aCIsImhhc1JvbGUiLCJnZXRBcGlVc2VyIiwicmVxdWlyZUFwaVJvbGUiLCJtZXNzYWdlIiwic3RhdHVzIiwiZ2V0Um9sZURhc2hib2FyZCIsIm5vcm1hbGl6ZWQiLCJkYXNoYm9hcmRzIiwiQlVZRVIiLCJTVVBQTElFUiIsIkZBQ1RPUlkiLCJXSE9MRVNBTEVSIiwiQ1JFQVRPUiIsIk9QUyIsIkFGRklMSUFURSIsIkFETUlOIiwiaXNQdWJsaWNSb3V0ZSIsInBhdGhuYW1lIiwicHVibGljUGF0aHMiLCJzb21lIiwic3RhcnRzV2l0aCIsImdldEFsbG93ZWRSb3V0ZXNGb3JSb2xlIiwicm91dGVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = global;\nconst prismaBase = globalForPrisma.prisma || new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log: [\n        \"query\"\n    ]\n});\nif (true) globalForPrisma.prisma = prismaBase;\n// Extend prisma with .query helper for compatibility with requested snippets\nconst db = Object.assign(prismaBase, {\n    query: async (sql, params = [])=>{\n        // Simple parameter replacement since $queryRawUnsafe doesn't take params array in the same way as some drivers\n        // Wait, $queryRawUnsafe DOES take parameters as additional arguments\n        return prismaBase.$queryRawUnsafe(sql, ...params);\n    }\n});\nconst prisma = db;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUE4QztBQUU5QyxNQUFNQyxrQkFBa0JDO0FBRXhCLE1BQU1DLGFBQ0ZGLGdCQUFnQkcsTUFBTSxJQUN0QixJQUFJSix3REFBWUEsQ0FBQztJQUNiSyxLQUFLO1FBQUM7S0FBUTtBQUNsQjtBQUVKLElBQUlDLElBQXlCLEVBQWNMLGdCQUFnQkcsTUFBTSxHQUFHRDtBQUVwRSw2RUFBNkU7QUFDdEUsTUFBTUksS0FBS0MsT0FBT0MsTUFBTSxDQUFDTixZQUFZO0lBQ3hDTyxPQUFPLE9BQU9DLEtBQWFDLFNBQWdCLEVBQUU7UUFDekMsK0dBQStHO1FBQy9HLHFFQUFxRTtRQUNyRSxPQUFPLFdBQW9CQyxlQUFlLENBQUNGLFFBQVFDO0lBQ3ZEO0FBQ0osR0FBRztBQUVJLE1BQU1SLFNBQVNHLEdBQUciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYW5hZGFtYS1wbGF0Zm9ybS8uL2xpYi9kYi50cz8xZGYwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcclxuXHJcbmNvbnN0IGdsb2JhbEZvclByaXNtYSA9IGdsb2JhbCBhcyB1bmtub3duIGFzIHsgcHJpc21hOiBQcmlzbWFDbGllbnQgfTtcclxuXHJcbmNvbnN0IHByaXNtYUJhc2UgPVxyXG4gICAgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSB8fFxyXG4gICAgbmV3IFByaXNtYUNsaWVudCh7XHJcbiAgICAgICAgbG9nOiBbJ3F1ZXJ5J10sXHJcbiAgICB9KTtcclxuXHJcbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hQmFzZTtcclxuXHJcbi8vIEV4dGVuZCBwcmlzbWEgd2l0aCAucXVlcnkgaGVscGVyIGZvciBjb21wYXRpYmlsaXR5IHdpdGggcmVxdWVzdGVkIHNuaXBwZXRzXHJcbmV4cG9ydCBjb25zdCBkYiA9IE9iamVjdC5hc3NpZ24ocHJpc21hQmFzZSwge1xyXG4gICAgcXVlcnk6IGFzeW5jIChzcWw6IHN0cmluZywgcGFyYW1zOiBhbnlbXSA9IFtdKSA9PiB7XHJcbiAgICAgICAgLy8gU2ltcGxlIHBhcmFtZXRlciByZXBsYWNlbWVudCBzaW5jZSAkcXVlcnlSYXdVbnNhZmUgZG9lc24ndCB0YWtlIHBhcmFtcyBhcnJheSBpbiB0aGUgc2FtZSB3YXkgYXMgc29tZSBkcml2ZXJzXHJcbiAgICAgICAgLy8gV2FpdCwgJHF1ZXJ5UmF3VW5zYWZlIERPRVMgdGFrZSBwYXJhbWV0ZXJzIGFzIGFkZGl0aW9uYWwgYXJndW1lbnRzXHJcbiAgICAgICAgcmV0dXJuIChwcmlzbWFCYXNlIGFzIGFueSkuJHF1ZXJ5UmF3VW5zYWZlKHNxbCwgLi4ucGFyYW1zKTtcclxuICAgIH1cclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgcHJpc21hID0gZGI7XHJcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWwiLCJwcmlzbWFCYXNlIiwicHJpc21hIiwibG9nIiwicHJvY2VzcyIsImRiIiwiT2JqZWN0IiwiYXNzaWduIiwicXVlcnkiLCJzcWwiLCJwYXJhbXMiLCIkcXVlcnlSYXdVbnNhZmUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.0.0_@babel+core@7.2_d581c8e324c8c8e93d52c4758017b76b","vendor-chunks/@swc+helpers@0.5.2","vendor-chunks/jose@6.1.3","vendor-chunks/bcryptjs@3.0.3"], () => (__webpack_exec__("(rsc)/../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=C%3A%5CUsers%5CABDULRAMAN%20LAWAL%5CDesktop%5CBanadama2.0%5Cbanadama-platform%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CABDULRAMAN%20LAWAL%5CDesktop%5CBanadama2.0%5Cbanadama-platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();